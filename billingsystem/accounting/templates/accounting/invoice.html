<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Billing System</title>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/invoice.css' %}" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>

    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script> -->
</head>

<body>
    <form method="post" id="form-container" enctype="multipart/form-data">
        {% csrf_token %}
   
        <div class="page-content container">
            <div class="page-header text-blue-d2">
                <h1 class="page-title text-secondary-d1">
                    Invoice
                    <small class="page-info">
                        <i class="fa fa-angle-double-right text-80"></i>
                        VAT/PAN: #111-222
                    </small>
                </h1>

                <div class="page-tools">
                    <div class="action-buttons">
                        <a class="btn bg-white btn-light mx-1px text-95" href="#" data-title="Print">
                            <i class="mr-1 fa fa-print text-primary-m1 text-120 w-2"></i>
                            Print
                        </a>
                        <a class="btn bg-white btn-light mx-1px text-95" href="#" data-title="PDF">
                            <i class="mr-1 fa fa-file-pdf-o text-danger-m1 text-120 w-2"></i>
                            Export
                        </a>
                    </div>
                </div>
            </div>

            <div class="container px-0">
                <div class="row mt-4">
                    <div class="col-12 col-lg-12">
                        <div class="row">
                            <div class="col-12">
                                <div class="text-center text-150">
                                    <i class="fa fa-book fa-2x text-success-m2 mr-1"></i>
                                    <span class="text-default-d3">Traders Pvt.Ltd</span>
                                </div>
                            </div>
                        </div>
                        <!-- .row -->

                        <hr class="row brc-default-l1 mx-n1 mb-4" />
                        {{ form.non_field_errors }}
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="text-grey-m2">
                                    <div class="row my-1">
                                        {{ form.customer_name.errors }}
                                        <div class="col-4 text-left"><label
                                                for="{{ form.customer_name.id_for_label }}">Customer Name:</label></div>
                                        <div class="col-2">{{ form.customer_name }}</div>
                                    </div>

                                    <div class="row my-1">
                                        {{ form.address.errors }}
                                        <div class="col-4 text-left"> <label
                                                for="{{ form.address.id_for_label }}">Address:</label></div>
                                        <div class="col-2">{{ form.address }}</div>
                                    </div>
                                    <div class="row my-1">
                                        {{ form.phone.errors }}
                                        <div class="col-4 text-left"> <label
                                                for="{{ form.phone.id_for_label }}">Phone:</label></div>
                                        <div class="col-2"> {{ form.phone }}</div>
                                    </div>
                                    <div class=" row my-1">
                                        {{ form.pan_no.errors }}
                                        <div class="col-4 text-left"> <label
                                                for="{{ form.pan_no.id_for_label }}">PAN:</label></div>
                                        <div class="col-2"> {{ form.pan_no }}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- /.col -->

                            <div class="text-95 col-sm-6 align-self-start d-sm-flex justify-content-end">
                                <hr class="d-sm-none" />
                                <div class="text-grey-m2">
                                    <div class=" row my-2">
                                        {{ form.invoice_no.errors }}
                                        <div class="col-5 text-right">
                                            <label for="{{ form.invoice_no.id_for_label }}">Invoice No:</label>
                                        </div>
                                        <div class="col-2" >{{ form.invoice_no }}</div>
                                    </div>
                                    {{ form.invoice_date.errors}}
                                    <div class="row my-2">
                                        <div class="col-5 text-right">
                                            <label for="{{ form.invoice_date.id_for_label }}">Invoice Date:</label>
                                        </div>
                                        <div class="col-2"> {{ form.invoice_date }}</div>
                                    </div>
                                    {{ form.payment_mode.errors }}
                                    <div class="row my-2">
                                        <div class="col-6 text-right">
                                            <label for="{{ form.payment_mode.id_for_label }}">Payment Mode:</label>
                                        </div>
                                        <div class="col-2"> {{ form.payment_mode }}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                   <!-- or use a table instead -->
                   <div class="bird-form">
                            <div class="table-responsive">
                                <table class="table table-striped table-borderless border-0 border-b-2 brc-default-l1">
                                    {{ iform.management_form }}
                                    <thead class="bg-none bgc-default-tp1">
                                        <tr class="text-white">
                                            {{ iform.item_no.errors }}
                                            <th><label for="{{ iform.item_no.id_for_label }}">S.N</label></th>
                                            {{ iform.particular.errors }}
                                            <th><label for="{{ iform.particular.id_for_label }}">Particular</label>
                                            </th>
                                            <!-- {{ iform.alt_qty.errors }}
                                            <th><label for="{{ iform.alt_qty.id_for_label }}">Alt Qty</label></th> -->
                                            {{ iform.qty.errors }}
                                            <th><label for="{{ iform.qty.id_for_label }}">Qty</label></th>
                                            {{ iform.Uom.errors }}
                                            <th><label for="{{ iform.Uom.id_for_label }}">Uom</label></th>
                                            {{ iform.rate.errors }}
                                            <th><label for="{{ iform.rate.id_for_label }}">Rate</label></th>
                                            {{ iform.discount.errors }}
                                            <th><label for="{{ iform.discount.id_for_label }}">Discount</label></th>
                                            {{ iform.amount.errors }}
                                            <th><label for="{{ iform.amount.id_for_label }}">Amount</label></th>
                                        </tr>
                                    </thead>
                                    {% for iforms in iform %}
                                    <tbody >
                                        <tr>
                                            <td>{{ iforms.item_no }}</td>
                                            <td>{{ iforms.particular }}</td>
                                            <!-- <td>{{ iforms.alt_qty }}</td> -->
                                            <td id="itemqty">{{ iforms.qty }}</td>
                                            <td>{{ iforms.Uom }}</td>
                                            <td id="itemrate">{{ iforms.rate }}</td>
                                            <td id="itemdiscount">{{ iforms.discount }}</td>
                                            <td id="itemamount">{{ iforms.amount }}</td>
                                        </tr>
                                    </tbody>
                                    {% endfor %}
                                </table> 
                                <input type="hidden" value="false" name="itemadd" id="itemadd">
                                <button class="btn btn-primary" id="additemsbutton">Add items</button>
                                <!-- <button id="add-form" type="button">Add Another Bird</button> -->
                            </div>
                        </div>
                            <div class="row mt-3">
                                <div class="col-12 col-sm-7 text-grey-d2 text-35 mt-2 mt-lg-0">
                                    <div class="row my-5"> 
                                    <div class="col-3 text-left">
                                    {{ calform.in_words.errors}}
                                    <label for="{{ calform.in_words.id_for_label }}">In Words:</label>
                                    </div>
                                    <div class="col-3">
                                    {{calform.in_words}}
                                    </div>
                                    </div>

                                    <div class="row my-5"> 
                                        <div class="col-3 text-left">
                                        {{ calform.remarks.errors}}
                                        <label for="{{ calform.in_words.id_for_label }}">Remarks:</label>
                                        </div>
                                        <div class="col-3">
                                        {{calform.remarks}}
                                        </div>
                                        </div>
                                </div>

                                <div class="col-12 col-sm-5 text-grey text-30 order-first order-sm-last">
                                    <div class="row my-2">
                                        {{ calform.subtotal.errors }}
                                        <div class="col-6 text-right">
                                            <label for="{{ calform.subtotal.id_for_label }}">Sub Total:</label>
                                        </div>
                                        <div class="col-2" id="calculatesubtotal">
                                           {{calform.subtotal}}
                                        </div>
                                    </div>
                                    <div class="row my-2">
                                        {{ calform.discount.errors }}
                                        <div class="col-6 text-right">
                                            <label for="{{ calform.discount.id_for_label }}">Discount:</label>
                                        </div>
                                        <div class="col-2" id="calculatediscount">
                                           {{ calform.discount }}
                                        </div>
                                    </div>
                                    <div class="row my-2">
                                        {{ calform.taxable_amount.errors }}
                                        <div class="col-6 text-right">
                                            <label for="{{ calform.taxable_amount.id_for_label }}">Taxable
                                                Amount:</label>
                                        </div>
                                        <div class="col-2" id="calculatetax">
                                            {{ calform.taxable_amount }}
                                        </div>
                                    </div>
                                    <div class="row my-2">
                                        {{ calform.vat.errors }}
                                        <div class="col-6 text-right">
                                            <label for="{{ calform.vat.id_for_label }}">VAT:</label>
                                        </div>
                                        <div class="col-1" id="calculatevat">
                                            {{ calform.vat }}
                                        </div>
                                    </div>
                                    <div class="row my-2">
                                        {{ calform.total_amount.errors }}
                                        <div class="col-6 text-right">
                                            <label for="{{ calform.total_amount.id_for_label }}">Total Amount:</label>
                                        </div>
                                        <div class="col-1" id="calculatetotalamount">
                                            {{ calform.total_amount }}
                                        </div>
                                    </div>
                                </div>
                            </div>

                         <hr/>  
                            <div class="row">
                                <div class="col-12">
                                    <div class="row my-1"> 
                                        <div class="col-2 text-left">
                                        {{ calform.received_by.errors}}
                                        <label for="{{ calform.received_by.id_for_label }}">Received By:</label>
                                        </div>
                                        
                                        {{calform.received_by}}
                                       
                                        <div class="col-2 text-left">
                                            {{ calform.prepared_by.errors}}
                                            <label for="{{ calform.prepared_by.id_for_label }}">Prepared By:</label>
                                        </div>
                                        
                                            {{calform.prepared_by}}
                                        
                                        <div class="col-2 text-left">
                                            {{ calform.authorized_sign.errors}}
                                            <label for="{{ calform.authorized_sign.id_for_label }}">Authorized Sign:</label>
                                        </div>
                                        
                                            {{calform.authorized_sign}}
                                    
                                    </div>
                                </div>
                            </div>
                        <hr/>

                            <div class="row my-2">
                                <div class="col text-left">
                                {{ calform.date_time.errors}}
                                <span class="text-secondary-d1 text-105"> 
                                    <label for="{{ calform.date_time.id_for_label }}">Print Date & Time:</label></span>
                                    {{ calform.date_time }}
                                </div>
                                    <div class="col text-right">
                                <input type="submit" class="btn btn-info btn-bold px-4 float-right mt-3 mt-lg-0"
                                    value="Submit"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
   
    </form> 
    <script>
        $(document).ready(function () {
            $("#additemsbutton").on('click', function (event) {
                $("#itemadd").val("true");
            });
        });
        
        $(document).ready(function () {
        $("#itemqty").on('keyup',function(){
            var itemquantity = parseFloat($("#itemqty").val());
            var itemrate = parseFloat($("#itemrate").val());
            $("#itemamount").html(itemquantity * itemrate);
           });
        });
        $("#itemrate").on('keyup',function(){
            var itemquantity =parseFloat($("#itemqty").val());
            var itemrate =parseFloat($("#itemrate").val());
            $("#itemamount").html(itemquantity * itemrate);
           });
    </script>
    <!-- <script>
        let birdForm = document.querySelectorAll(".bird-form")
        let container = document.querySelector("#form-container")
        let addButton = document.querySelector("#add-form")
        let totalForms = document.querySelector("#id_form-TOTAL_FORMS")

        let formNum = birdForm.length-1
        addButton.addEventListener('click', addForm)

        function addForm(e){
            e.preventDefault()

            let newForm = birdForm[0].cloneNode(true)
            let formRegex = RegExp(`form-(\\d){1}-`,'g')

            formNum++
            newForm.innerHTML = newForm.innerHTML.replace(formRegex, `form-${formNum}-`)
            container.insertBefore(newForm, addButton)
            
            totalForms.setAttribute('value', `${formNum+1}`)
        };
    </script> -->
</body>
</html>
