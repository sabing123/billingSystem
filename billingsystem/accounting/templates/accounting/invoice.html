{% extends 'accounting/main.html' %}

{% load static %}

{% block content %}
{% include 'accounting/navigation.html'%}
    <form method="post" id="form-container" enctype="multipart/form-data">
        {% csrf_token %}
   
        <div class="page-content container">
            <div class="page-header text-blue-d2">
                <h1 class="page-title text-secondary-d1">
                    <small class="page-info">
                        <!-- <i class="fa fa-angle-double-right text-80"></i> -->
                        VAT No: 606678199
                    </small>
                </h1>

                <div class="page-tools">
                    <div class="action-buttons">
                        <a class="btn bg-white btn-light mx-1px text-95" href="#" data-title="Print">
                            <i class="mr-1 fa fa-print text-primary-m1 text-120 w-2"></i>
                            Print
                        </a>
                        <a class="btn bg-white btn-light mx-1px text-95" href="#" data-title="PDF">
                            <i class="mr-1 fa fa-file-pdf-o text-danger-m1 text-120 w-2"></i>
                            Export
                        </a>
                    </div>
                </div>
            </div>

            <div class="container px-0">
                <div class="row mt-4">
                    <div class="col-12 col-lg-12">
                        <div class="row">
                            <div class="col-12">
                                <div class="text-center text-150">
                                    <!-- <i class="fa fa-book fa-2x text-success-m2 mr-1"></i> -->
                                    <h4>DV Trading PVT.LTD</h4>
                                    <h6>Head office-Janakpur-04 Dhanusha</h6>
                                    <h6>Branch office-Kuleshwor-14 Kathmandu</h6>
                                    <h6>Contact No: 977-1-4285484, 4287358</h6>
                                    <span class="text-default-d3">TAX INVOICE</span>
                                </div>
                            </div>
                        </div>
                        <!-- .row -->

                        <hr class="row brc-default-l1 mx-n1 mb-4" />
                        {{ form.non_field_errors }}
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="text-grey-m2">
                                    <div class="row my-1">
                                        {{ form.customer_name.errors }}
                                        <div class="col-4 text-left"><label
                                                for="{{ form.customer_name.id_for_label }}">Customer Name:</label></div>
                                        <div class="col-2">{{ form.customer_name }}</div>
                                    </div>

                                    <div class="row my-1">
                                        {{ form.address.errors }}
                                        <div class="col-4 text-left"> <label
                                                for="{{ form.address.id_for_label }}">Address:</label></div>
                                        <div class="col-2">{{ form.address }}</div>
                                    </div>
                                    <div class="row my-1">
                                        {{ form.phone.errors }}
                                        <div class="col-4 text-left"> <label
                                                for="{{ form.phone.id_for_label }}">Phone:</label></div>
                                        <div class="col-2"> {{ form.phone }}</div>
                                    </div>
                                    <div class=" row my-1">
                                        {{ form.pan_no.errors }}
                                        <div class="col-4 text-left"> <label
                                                for="{{ form.pan_no.id_for_label }}">VAT/PAN:</label></div>
                                        <div class="col-2"> {{ form.pan_no }}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- /.col -->

                            <div class="text-95 col-sm-6 align-self-start d-sm-flex justify-content-end">
                                <hr class="d-sm-none" />
                                <div class="text-grey-m2">
                                    <div class=" row my-2">
                                        {{ form.invoice_no.errors }}
                                        <div class="col-5 text-right">
                                            <label for="{{ form.invoice_no.id_for_label }}">Invoice No:</label>
                                        </div>
                                        <div class="col-2" >{{ form.invoice_no }}</div>
                                    </div>
                                    {{ form.invoice_date.errors}}
                                    <div class="row my-2">
                                        <div class="col-5 text-right">
                                            <label for="{{ form.invoice_date.id_for_label }}">Invoice Date:</label>
                                        </div>
                                        <div class="col-2"> {{ form.invoice_date }}</div>
                                    </div>
                                    {{ form.payment_mode.errors }}
                                    <div class="row my-2">
                                        <div class="col-6 text-right">
                                            <label for="{{ form.payment_mode.id_for_label }}">Payment Mode:</label>
                                        </div>
                                        <div class="col-2"> {{ form.payment_mode }}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                   <!-- or use a table instead -->
                   <div class="bird-form">
                            <div class="table-responsive">
                                <table class="table table-striped table-borderless border-0 border-b-2 brc-default-l1">
                                  
                                    <thead class="bg-none bgc-default-tp1">
                                        <tr class="text-white">
                                            {{ iform.item_no.errors }}
                                            <th><label for="{{ iform.item_no.id_for_label }}">S.N</label></th>
                                            {{ iform.particular.errors }}
                                            <th><label for="{{ iform.particular.id_for_label }}">Particular</label>
                                            </th>
                                            {{ iform.alt_qty.errors }}
                                            <th><label for="{{ iform.alt_qty.id_for_label }}">Alt Qty</label></th>
                                            {{ iform.quantity.errors }}
                                            <th><label for="{{ iform.quantity.id_for_label }}">Qty</label></th>
                                            {{ iform.Uom.errors }}
                                            <th><label for="{{ iform.Uom.id_for_label }}">Uom</label></th>
                                            {{ iform.rate.errors }}
                                            <th><label for="{{ iform.rate.id_for_label }}">Rate</label></th>
                                            {{ iform.discount.errors }}
                                            <th><label for="{{ iform.discount.id_for_label }}">Discount</label></th>
                                            {{ iform.amount.errors }}
                                            <th><label for="{{ iform.amount.id_for_label }}">Amount</label></th>
                                        </tr>
                                    </thead>
                                    {{ iform.management_form }}
                                    {% for iforms in iform %}
                                    <tbody>
                                        <tr class="link-formset">
                                            <td>{{ iforms.item_no }}</td>
                                            <td>{{ iforms.particular }}</td>
                                            <td>{{ iforms.alt_qty }}</td>
                                            <td>{{ iforms.quantity }}</td>
                                            <td>{{ iforms.Uom }}</td>
                                            <td>{{ iforms.rate }}</td>
                                            <td>{{ iforms.discount }}</td>
                                            <td>{{ iforms.amount }}</td>
                                        </tr>
                                    </tbody>
                                    {% endfor %}
                                </table> 
                                <!-- <input type="hidden" value="false" name="itemadd" id="itemadd">
                                <button class="btn btn-primary" id="additemsbutton">Add items</button> -->            
                            </div>
                        </div>
                            <div class="row mt-3">
                                <div class="col-12 col-sm-7 text-grey-d2 text-35 mt-2 mt-lg-0">
                                    <div class="row my-5"> 
                                    <div class="col-3 text-left">
                                    {{ form.in_words.errors}}
                                    <label for="{{ form.in_words.id_for_label }}">In Words:</label>
                                    </div>
                                    <div class="col-3">
                                    {{form.in_words}}
                                    </div>
                                    </div>

                                    <div class="row my-5"> 
                                        <div class="col-3 text-left">
                                        {{ form.remarks.errors}}
                                        <label for="{{ form.in_words.id_for_label }}">Remarks:</label>
                                        </div>
                                        <div class="col-3">
                                        {{form.remarks}}
                                        </div>
                                        </div>
                                </div>

                                <div class="col-12 col-sm-5 text-grey text-30 order-first order-sm-last">
                                    <div class="row my-2">
                                        {{ form.subtotal.errors }}
                                        <div class="col-6 text-right">
                                            <label for="{{ form.subtotal.id_for_label }}">Sub Total:</label>
                                        </div>
                                        <div class="col-2" id="calculatesubtotal">
                                           {{form.subtotal}}
                                        </div>
                                    </div>
                                    <div class="row my-2">
                                        {{ form.discount.errors }}
                                        <div class="col-6 text-right">
                                            <label for="{{ form.discount.id_for_label }}">Discount:</label>
                                        </div>
                                        <div class="col-2" id="calculatediscount">
                                           {{ form.discount }}
                                        </div>
                                    </div>
                                    <div class="row my-2">
                                        {{ form.taxable_amount.errors }}
                                        <div class="col-6 text-right">
                                            <label for="{{ form.taxable_amount.id_for_label }}">Taxable
                                                Amount:</label>
                                        </div>
                                        <div class="col-2" id="calculatetax">
                                            {{ form.taxable_amount }}
                                        </div>
                                    </div>
                                    <div class="row my-2">
                                        {{ form.vat.errors }}
                                        <div class="col-6 text-right">
                                            <label for="{{ form.vat.id_for_label }}">VAT:</label>
                                        </div>
                                        <div class="col-1" id="calculatevat">
                                            {{ form.vat }}
                                        </div>
                                    </div>
                                    <div class="row my-2">
                                        {{ form.total_amount.errors }}
                                        <div class="col-6 text-right">
                                            <label for="{{ form.total_amount.id_for_label }}">Total Amount:</label>
                                        </div>
                                        <div class="col-1" id="calculatetotalamount">
                                            {{ form.total_amount }}
                                        </div>
                                    </div>
                                </div>
                            </div>

                         <hr/>  
                            <div class="row">
                                <div class="col-12">
                                    <div class="row my-1"> 
                                        <div class="col-2 text-left">
                                        {{ form.received_by.errors}}
                                        <label for="{{ form.received_by.id_for_label }}">Received By:</label>
                                        </div>
                                        
                                        {{form.received_by}}
                                       
                                        <div class="col-2 text-left">
                                            {{ form.prepared_by.errors}}
                                            <label for="{{ form.prepared_by.id_for_label }}">Prepared By:</label>
                                        </div>
                                        
                                            {{form.prepared_by}}
                                        
                                        <div class="col-2 text-left">
                                            {{ form.authorized_sign.errors}}
                                            <label for="{{ form.authorized_sign.id_for_label }}">Authorized Sign:</label>
                                        </div>
                                        
                                            {{form.authorized_sign}}
                                    
                                    </div>
                                </div>
                            </div>
                        <hr/>

                            <div class="row my-2">
                                <div class="col text-left">
                                {{ form.date_time.errors}}
                                <span class="text-secondary-d1 text-105"> 
                                    <label for="{{ form.date_time.id_for_label }}">Print Date & Time:</label></span>
                                    {{ form.date_time }}
                                </div>
                                    <div class="col text-right">
                                <input type="submit" class="btn btn-info btn-bold px-4 float-right mt-3 mt-lg-0"
                                    value="Submit"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form> 
    {{ form.media }}
    <script>    
        $(document).ready(function () {
            $("#id_form-0-quantity").keyup(function(){
                var itemquantity = parseFloat($(this).html())
                var itemrate = parseFloat($("#id_form-0-rate").html())
                $("#id_form-0-amount").text(itemquantity * itemrate);
               });
            
            $("#id_form-0-rate").keyup(function(){
                var itemquantity =parseFloat($("#id_form-0-quantity").html());
                var itemrate =parseFloat($(this).html());
                $("#id_form-0-amount").text(itemquantity * itemrate);
               });
        });

    </script>
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="{% static '/js/jquery.formset.js' %}"></script>
    <script type="text/javascript" >
        $('.link-formset').formset({
            addText: 'Add Item',
            deleteText: 'Remove'
        });
    </script>

{% endblock %}
<!-- $(document).ready(function () {
    $("#additemsbutton").on('click', function (event) {
        $("#itemadd").val("true");
    });
}); -->